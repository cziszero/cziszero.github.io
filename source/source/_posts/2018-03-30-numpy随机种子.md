---
layout: post
title: numpy、python random、tensorflow随机种子设置
description: 
date: 2018-03-30
categories: 
  - [numpy] 
tags:
  - numpy
---

# numpy、python random

numpy可以使用np.random.seed(2)来设置初始化种子

1. 每次设置seed之后都会重新初始化随机数发生器，计数器会置零
2. 设置seed是全局的，不同文件也是通用的

python内置的random也是一样的

# tensorflow

tf的random seed分为两个层次，graph level 和 operation level
1. 都不设置--> 每次都不一样
2. 只设置operation的random seed，对于每个Session，operation random会重新初始化，结果是可复现的。
3. 只设置graph-level，即使用`tf.set_random_seed()`设置，对于每个Session，random状态也会初始化，同时operation如果没有特别指定的话，由系统自动根据graph level的seed指定，不同Session之间也是可复现的。
4. 同时指定graph level 和operation level的random seed，也是可复现的，不过和只指定其中一个生成的随机数是不一样。

总的来说，对于某个operation，任意指定graph level 或operation level中的random seed，生成的随机数就是确定的，但生成的随机数列是不一样的。
特别注意：op声明的时候就应该已经设置了graph level的random seed`tf.set_random_seed(1)`，否则对于该op相当于没有设置random seed。
例如下面的代码：
```python
import tensorflow as tf
a = tf.truncated_normal([3], stddev=0.1))#相当于op c没有设置random seed
tf.set_random_seed(1)
a = tf.truncated_normal([3], stddev=0.1)#相当于op a的random seed为1+hash(a)
tf.set_random_seed(2)
b = tf.truncated_normal([3], stddev=0.1)#相当于op b的random seed为2+hash(b)

print("Session 1")
with tf.Session() as sess1:
  print(sess1.run(a))
  print(sess1.run(b))
  print(sess1.run(c))

print("Session 2")
with tf.Session() as sess2:
  print(sess2.run(a))
  print(sess2.run(b))
  print(sess2.run(c))
```